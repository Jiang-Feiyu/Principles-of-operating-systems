# PCB
进程控制块(Process Control Block,PCB)是存储关于进程的信息的个体结构. 

在切换进程时，操作系统必须保存和恢复基础和界限寄存器。具体来说，当操作系统决定中止当前的运行进程时，它必须将当前基址和界限寄存器中的内容保存在内存中，放在某种每个进程都有的结构中，如进程结构或进程控制块中. 

在切换线程时，类似的，我们使用TCB(Thread Control Block)来保存线程状态

# User mode和Kernel mode 
硬件通过提供不同的执行模式来协助操作系统

- 在用户模式(user mode)下，应用程序不能完全访问硬件资源。在用户模式下运行的代码会受到限制。例如，在用户模式下运行时，进程不能发出 I/O 请求。这样做会导致处理器引发异常，操作系统可能会终止进程

- 在内核模式(kernel mode)下，操作系统可以访问机器的全部资源。在此模式下，运行的代码可以做它喜欢的事，包括特权操作，如发出 I/O 请求和执行所有类型的受限指令

采用受保护的控制权转移

- 要执行系统调用，程序必须执行特殊的陷阱(trap)指令。该指令同时跳入内核并将特权级别提升到内核模式。一旦进入内核，系统就可以执行任何需要的特权操作(如果允许)， 从而为调用进程执行所需的工作。完成后，操作系统调用一个特殊的从陷阱返回`return-from-trap`指令，该指令返回到发起调用的用户程序中，同时将特权级别降低，回到用户模式

<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6db5d9c0afdc49599c91d8d551688d5d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=600&h=490&s=69921&e=png&b=fefefe" alt="螢幕截圖 2023-12-05 下午2.17.37.png" width="50%" />

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58a76156fdb74c0fb6f2ce21ad9ba182~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1896&h=1136&s=410226&e=png&b=fbf4f2" alt="螢幕截圖 2023-12-05 下午2.19.44.png" width="70%" />

# Interrupt
- Hardware Interrupt
硬中断由外部设备（例如：磁盘，网卡，键盘，时钟）产生，用来通知操作系统外设状态变化

- Software Interrupt
软中断是一条 CPU 指令，由当前正在运行的进程产生，常见的有：
    - **系统调用**
    - 异常情况

# Signal
- 实现方式：信号基本上是通过系统调用实现的，例如 `kill()`、`signal()`、`sigaction()`、`raise()`、`pause()`、`sigsuspend()` 等，每个信号都由一个数值或符号名称表示
- 生成：
    - **同步信号：** 信号可以是同步的，即由当前运行的进程的当前指令触发，并由操作系统立即传递给该进程。例如，非法内存访问或除零操作会引发信号。
    - **异步信号：** 信号也可以是异步的，由外部事件或活动生成，而不是由目标进程当前的活动触发。这些信号可能在程序执行期间的不可预测时间到达，例如定时器警报或父进程使用 `kill()` 系统调用终止子进程。
- 信号处理：
    - **信号处理方式：** 进程可以决定对信号做出不同的响应，如捕获、忽略或屏蔽。捕获信号涉及在进程中预先指定一个例程（信号处理程序），当进程接收到该信号时，操作系统会调用该处理程序。`signal()` 或 `sigaction()` 系统调用可用于指定信号处理程序。
    - **信号屏蔽：** 屏蔽信号是指告诉操作系统在进程清除信号掩码之前不要传递该类型的信号。一些信号，如 `SIGKILL` 和 `SIGSTOP`，不能被捕获、屏蔽或忽略。

# 信号和中断比较
区别：
- **中断由硬件产生，而信号由内核或其他进程产生**
- 中断有优先级，而信号没有优先级，所有的信号都是平等的
- 信号处理程序是在用户态下运行的，而中断处理程序是在核心态下运行
- 中断响应是及时的，而信号响应通常都有较大的时间延迟
